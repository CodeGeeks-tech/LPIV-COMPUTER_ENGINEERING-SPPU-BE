âœ… CODE EXPLANATION â€” Diabetes Prediction using K-Nearest Neighbors (KNN)

This program uses the PIMA Indian Diabetes Dataset to build a K-Nearest Neighbors classifier that predicts whether a patient is diabetic (Outcome = 1) or not (Outcome = 0). It also computes key performance metrics like accuracy, precision, recall, and F1-score.

ðŸ“Œ 1. Importing Required Libraries
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import confusion_matrix, accuracy_score, precision_score, recall_score, f1_score

âœ” Explanation:

numpy & pandas â†’ handle numerical data and tabular data.

train_test_split â†’ divides dataset into training and testing sets.

KNeighborsClassifier â†’ KNN algorithm implementation.

metrics â†’ used to evaluate model performance.

ðŸ“Œ 2. Loading the Dataset
data = pd.read_csv('./diabetes.csv')
print(data.head())

âœ” Explanation:

Loads the diabetes dataset.

head() prints first 5 rows for verification.

Dataset contains:

Pregnancies, Glucose, BloodPressure, SkinThickness, Insulin, BMI, Age, etc.

Outcome â†’ the target column (1 = diabetic, 0 = non-diabetic).

ðŸ“Œ 3. Checking for Missing Values
data.isnull().sum()

âœ” Explanation:

Checks if dataset contains null values.

This dataset typically does not have NULLs but has zeros in some fields which are invalid medically (e.g., zero glucose).

ðŸ“Œ 4. Replacing Zero Values with Mean
cols_to_replace = ['Glucose','BloodPressure','SkinThickness','Insulin','BMI']

for column in cols_to_replace:
    data[column].replace(0, np.nan, inplace=True)
    data[column].fillna(round(data[column].mean(skipna=True)), inplace=True)

âœ” Explanation:

Certain medical readings cannot be zero:

Glucose cannot be 0

Blood pressure cannot be 0

Skin thickness, Insulin, BMI cannot be 0

So the steps are:

Replace 0 with NaN

Replace NaN with column mean

This improves accuracy by preventing wrong values.

ðŸ“Œ 5. Feature and Target Selection
X = data.iloc[:, :8]   # first 8 columns are features
Y = data['Outcome']    # target column

âœ” Explanation:

X contains all patient medical features.

Y contains the output label:

0 â†’ Not diabetic

1 â†’ Diabetic

ðŸ“Œ 6. Splitting Training & Testing Data
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=0)

âœ” Explanation:

80% training data

20% testing data

random_state=0 â†’ ensures consistent splitting.

ðŸ“Œ 7. Initializing and Training KNN Model
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, Y_train)

âœ” Explanation:

KNN uses 5 nearest neighbors (k=5).

The algorithm classifies a new sample based on voting from its nearest neighbors in feature space.

fit() trains the model.

ðŸ“Œ 8. Making Predictions
knn_pred = knn.predict(X_test)

âœ” Explanation:

Model predicts diabetes for test dataset.

ðŸ“Œ 9. Evaluating Model Performance
âœ” Confusion Matrix
cm = confusion_matrix(Y_test, knn_pred)

	Predicted Non-Diabetic	Predicted Diabetic
Actual Non-Diabetic	True Negative (TN)	False Positive (FP)
Actual Diabetic	False Negative (FN)	True Positive (TP)
âœ” Accuracy
accuracy = accuracy_score(Y_test, knn_pred)


Accuracy = Correct Predictions / Total Predictions

âœ” Error Rate
error_rate = 1 - accuracy


Error Rate = fraction of incorrect predictions.

âœ” Precision
precision = precision_score(Y_test, knn_pred)


Precision = TP / (TP + FP)
(How many predicted diabetics are actually diabetic?)

âœ” Recall (Sensitivity)
recall = recall_score(Y_test, knn_pred)


Recall = TP / (TP + FN)
(How many actual diabetics were correctly identified?)

âœ” F1 Score
f1 = f1_score(Y_test, knn_pred)


F1 Score = harmonic mean of precision and recall
(Useful when classes are imbalanced)

ðŸ“Œ 10. Printing All Results
print("Confusion Matrix:\n", cm)
print("Accuracy Score:", accuracy)
print("Error Rate:", error_rate)
print("Precision Score:", precision)
print("Recall Score:", recall)
print("F1 Score:", f1)

âœ” Explanation:

Displays all major evaluation metrics needed for medical prediction models.

ðŸŽ¯ FINAL SUMMARY â€” What This Program Does

âœ” Loads a diabetes dataset
âœ” Cleans invalid values (replacing zeros with mean)
âœ” Splits data into training/testing sets
âœ” Applies KNN to predict diabetes
âœ” Calculates 5 performance metrics:

Confusion Matrix

Accuracy

Error Rate

Precision

Recall

F1 Score

âœ” Helps understand how well the KNN classifier performs on medical diagnosis data.